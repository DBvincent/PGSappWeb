var download="http://a.app.qq.com/o/simple.jsp?pkgname=com.dashuf.disp.v2";var registerData={cv:"10"};var headers={"content-type":"application/json"};var check="false";var obj={};$(function(){find();isFrist(obj);getAjax("POST","../../guest/dictionary/businessCities",headers," ",getBusinessCityData);inputView();clickView()});function inputView(){$("#tel").focus(function(){openButton();if($(this).attr("placeholder")=="手机号不能为空"||$(this).attr("placeholder")=="手机号输入有误"){$(this).removeClass("error");$(this).attr("placeholder","请输入手机号码");$(this).val("")}$(this).attr("type","tel");$(this).css("color","#666666")});$("#pass").focus(function(){openButton();if($(this).attr("placeholder")=="您输入的密码格式有误"||$(this).attr("placeholder")=="密码不能为空"){$(this).removeClass("error");$(this).attr("placeholder","字母+数字组合，大于等于8位");$(this).val("")}$(this).css("color","#666666")});$("#verification").focus(function(){openButton();if($(this).attr("placeholder")=="错误"){$(this).removeClass("error");$(this).attr("placeholder","错误,请重新获取");$(this).val("")}$(this).css("color","#666666")});$("#choose").focus(function(){openButton();console.log(1);if(check=="true"){check="false"}else{check="true"}});$("#tel").blur(function(){verifyTelphone(this)});$("#pass").blur(function(){checkPass(this)});$("#verification").blur(function(){verifyNumber(this)})}function clickView(){$("#news").click(function(){getAjax("POST","../../guest/register/passcode",headers,JSON.stringify({cellphone:$("#tel").val(),CV:"10"}),getVerificationCode)});$("#btn").click(function(){console.log("进入提交");if($("#choose").is(":checked")){if(verify()){getData();toAjax("POST","../../guest/register/new",headers,registerData,submitRequest)}}else{$("#layer p").html("请阅读点击用户协议");$("#layer").fadeIn();$("#layer").fadeOut(2000)}});$("#user").click(function(a){a.preventDefault();save();self.location="https://disp-dashboard.banketech.com/static/files/agreement.html"});$("#city").click(function(){$(this).css("color","#666666");openButton()});$("#city").click(function(){$(".footer").hide()})}function getData(){registerData.cellphone=$("#tel").val();registerData.password=$("#pass").val();registerData.businessCityCode=$("#city").attr("data-code");registerData.passcode=$("#verification").val();registerData.registerCode=GetQueryString("requestId")}function popPeer(b){var a=new LArea();a.init({trigger:"#city",keys:{id:"code",name:"name"},type:1,data:b,idx:1});a.className=["area_company"]}function checkPass(b){var a=$(b).val();if(!(/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{8,}$/.test(a))){$(b).addClass("error");$(b).val("");closeButton();$(b).attr("placeholder","您输入的密码格式有误")}else{if(a==""){$(b).addClass("error");$(b).val("");$(b).attr("placeholder","密码不能为空");closeButton()}else{$(b).val(a)}}}function verifyTelphone(b){var a=$(b).val();if(a==""){$(b).addClass("error");$(b).val("");$(b).attr("placeholder","手机号不能为空");closeButton()}else{if(!(/^1[34578]\d{9}$/.test(a))){$(b).addClass("error");$(b).val("");$(b).attr("placeholder","手机号输入有误");closeButton()}else{$(b).val(a)}}}function verifyNumber(a){var b=$(a).val();if(b==""){$(a).addClass("error");$(a).val("");$(a).attr("placeholder","验证码错误");closeButton()}else{$(a).val(b)}}function verifyCity(a){var b=$(a).html();if(b=="请选择"){$(a).html("业务城市不能为空");$(a).css("color","#ef6762");closeButton()}else{$(a).html(b);$(a).css("color","#666666")}}function removeByValue(a,c){for(var b=0;b<a.length;b++){if(a[b].name==c){a.splice(b,1);break}}}function verify(){if($("#tel").val()==""||$("#pass").val()==""||$("#verification").val()==""||$("#city").html()=="常驻城市不能为空"){verifyTelphone($("#tel"));checkPass($("#pass"));verifyNumber($("#verification"));verifyCity($("#city"));closeButton();return false}else{console.log("填写成功");openButton();return true}}function closeButton(){$("#btn").attr("disabled","disabled");$("#btn").css("background","#d3d3d3")}function openButton(){$("#btn").removeAttr("disabled");$("#btn").css("background","#fec43f")}function errorTip(c,d,b,a){closeButton();$("#layer p").html(d);$("#layer").fadeIn(b);$("#layer").fadeOut(a,function(){$("#verification").val("");openButton()})}function successTip(a){$("#layer p").html(a);$("#layer").fadeIn();$("#layer").fadeOut(1000,function(){localStorage.clear();self.location=download})}function getBusinessCityData(a){if(a.succeed){removeByValue(a.data,"客户挖掘中心");$.map(a.data,function(b){b.name=b.name.split("分公司")[0]});popPeer(a.data)}else{errorTip(a,"服务器开小差，请稍后再试",1000,2000)}}function getVerificationCode(a){if(a.succeed){$("#news").attr("disabled","disabled");$("#layer p").html("验证码已奔向您的手机，请等待");$("#layer").fadeIn();$("#layer").fadeOut(2000,function(){$("#news").removeAttr("disabled")});registerData.requestId=a.data}else{errorTip(a,a.message,1000,2000)}}function submitRequest(a){if(a.succeed){successTip("注册成功，正在跳转下载页面")}else{errorTip(a,a.message,1000,2000)}}function getAjax(c,a,e,b,d){$.ajax({type:c,url:a,headers:e,data:b,success:function(f){d(f)},error:function(f){errorTip(f,"服务器开小差，请稍后再试",1000,300000)}})}function toAjax(c,a,e,b,d){$.ajax({type:c,url:a,headers:e,data:JSON.stringify(b),success:function(f){d(f)},error:function(f){errorTip(f,"服务器开小差，请稍后再试",1000,300000)}})}function GetQueryString(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)","i");var c=window.location.search.substr(1).match(b);if(c!=null){return(c[2])}return null}function save(){localStorage.setItem("isFrist","1");localStorage.setItem("tel",$("#tel").val());localStorage.setItem("pass",$("#pass").val());localStorage.setItem("dataCode",$("#city").attr("data-code"));localStorage.setItem("city",$("#city").html());localStorage.setItem("passcode",$("#verification").val())}function find(){var e=window.localStorage;for(var c=0,a=e.length;c<a;c++){var b=e.key(c);var d=e.getItem(b);obj[b]=d;console.log(b+"="+d)}console.log(obj)}function isFrist(a){if(a.isFrist=="1"){if(a.tel){$("#tel").val(a.tel)}if(a.pass){$("#pass").val(a.pass)}if(a.dataCode){$("#city").attr("data-code",a.dataCode)}if(a.city!="请选择"){$("#city").html(a.city)}if(a.passcode){$("#verification").val(a.passcode)}localStorage.clear()}else{return}};